---
title: Proxy
description: Crie um proxy reverso de alta performance com AzuraJS
category: Recursos
icon: lucide:globe
order: 5
---

# Proxy üåê

O middleware de proxy reverso do AzuraJS permite o encaminhamento √°gil de requisi√ß√µes para servidores externos. √â uma ferramenta essencial para unificar endpoints de API, contornar restri√ß√µes de CORS ou balancear carga entre microsservi√ßos.

## Configura√ß√£o B√°sica

Integre o middleware `proxyPlugin` diretamente em sua inst√¢ncia `AzuraClient` para come√ßar a encaminhar requisi√ß√µes.

```typescript
import { AzuraClient } from "azurajs";
import { proxyPlugin } from "azurajs/plugins";

const app = new AzuraClient();

// Encaminha todas as requisi√ß√µes de /api para o servidor backend
app.use("/api", proxyPlugin("http://localhost:8080"));

await app.listen(3000);
```

## Op√ß√µes de Proxy

O `proxyPlugin` aceita um objeto de configura√ß√£o para controle preciso sobre o tratamento das requisi√ß√µes.

```typescript
import { AzuraClient } from "azurajs";
import { proxyPlugin } from "azurajs/plugins";

const app = new AzuraClient();

app.use(
  "/api",
  proxyPlugin("http://localhost:8080", {
    pathRewrite: {
      "^/api": "/",
    },
    headers: {
      "X-Custom-Header": "AzuraJS-Proxy",
    },
    timeout: 5000,
    followRedirects: false,
    preserveHost: true,
    logLevel: "debug",
    onProxyReq: (proxyReq, req) => {
      proxyReq.setHeader("X-Real-IP", req.ip);
    },
    onProxyRes: (proxyRes, req, res) => {
      proxyRes.headers["x-proxied-by"] = "AzuraJS";
    },
    onError: (err, req, res) => {
      res.status(500).json({ error: "Erro de Proxy", details: err.message });
    },
  }),
);

await app.listen(3000);
```

### Detalhes das Op√ß√µes

| Op√ß√£o             | Tipo                                               | Descri√ß√£o                                                       |
| :---------------- | :------------------------------------------------- | :-------------------------------------------------------------- |
| `target`          | `string`                                           | **Obrigat√≥rio**. URL base do servidor de destino.               |
| `pathRewrite`     | `Record<string, string>`                           | Regras de reescrita de caminho baseadas em Regex.               |
| `headers`         | `Record<string, string>`                           | Cabe√ßalhos personalizados anexados √†s requisi√ß√µes encaminhadas. |
| `timeout`         | `number`                                           | Dura√ß√£o do timeout da requisi√ß√£o em ms. Padr√£o: `30000`.        |
| `followRedirects` | `boolean`                                          | Se deve seguir redirecionamentos do destino. Padr√£o: `false`.   |
| `preserveHost`    | `boolean`                                          | Preserva o cabe√ßalho `Host` original. Padr√£o: `false`.          |
| `logLevel`        | `"info" \| "warn" \| "error" \| "debug" \| "none"` | N√≠vel de verbosidade dos logs do proxy. Padr√£o: `"info"`.       |
| `onProxyReq`      | `Function`                                         | Callback para modificar a requisi√ß√£o antes do encaminhamento.   |
| `onProxyRes`      | `Function`                                         | Callback para inspecionar/modificar a resposta do destino.      |
| `onError`         | `Function`                                         | Callback para lidar com falhas na requisi√ß√£o do proxy.          |

## Pr√≥ximos Passos üìñ

- [‚ö° **Modo Cluster**](/docs/pt/framework/recursos/cluster-mode): Combine o proxy com o modo cluster para alta disponibilidade.
- [üåê **CORS**](/docs/pt/framework/recursos/cors): Use o proxy para resolver problemas de CORS entre diferentes origens.
