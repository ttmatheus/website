---
title: AzuraJS CDN
description: Gerencie cache, URLs assinadas e purga de CDN com AzuraJS
category: Recursos
icon: lucide:cloud
order: 9
---

# AzuraJS CDN ‚òÅÔ∏è

O pacote `@azurajs/cdn` integra perfeitamente funcionalidades de Redes de Entrega de Conte√∫do (CDN) √† sua aplica√ß√£o. Ele simplifica opera√ß√µes como a gera√ß√£o de URLs assinadas para acesso seguro a recursos privados e a purga program√°tica de cache para garantir a atualiza√ß√£o do conte√∫do.

## Instala√ß√£o

Adicione o pacote ao seu projeto:

<Tabs items={["npm", "pnpm", "yarn", "bun"]}>
  <Tab value="npm">```bash npm install @azurajs/cdn ```</Tab>
  <Tab value="pnpm">```bash pnpm add @azurajs/cdn ```</Tab>
  <Tab value="yarn">```bash yarn add @azurajs/cdn ```</Tab>
  <Tab value="bun">```bash bun add @azurajs/cdn ```</Tab>
</Tabs>

## Configura√ß√£o

Configure as defini√ß√µes do seu provedor CDN no `azura.config.ts`.

```typescript
// azura.config.ts
import type { ConfigTypes } from "azurajs/config";

const config: ConfigTypes = {
  cdn: {
    provider: "cloudflare",
    apiKey: process.env.CDN_API_KEY,
    domain: "cdn.seusite.com",
    cloudflare: {
      zoneId: process.env.CLOUDFLARE_ZONE_ID,
      email: process.env.CLOUDFLARE_EMAIL,
    },
  },
};

export default config;
```

## Gera√ß√£o de URLs Assinadas

Conceda acesso tempor√°rio e seguro a recursos privados sem expor as credenciais de armazenamento subjacentes usando URLs assinadas.

```typescript
import { Controller, Get, Query } from "azurajs/decorators";
import { AzuraCDN } from "@azurajs/cdn";

@Controller("/files")
export class FileController {
  private cdnService: AzuraCDN;

  constructor() {
    this.cdnService = new AzuraCDN();
  }

  @Get("/download")
  async getSignedUrl(@Query("path") filePath: string) {
    if (!filePath) {
      return { error: "Caminho do arquivo √© obrigat√≥rio" };
    }
    const signedUrl = await this.cdnService.getSignedUrl(filePath, {
      expiresIn: 3600,
    });
    return { signedUrl };
  }
}
```

### Op√ß√µes de `getSignedUrl`

| Op√ß√£o         | Tipo     | Descri√ß√£o                                             |
| :------------ | :------- | :---------------------------------------------------- |
| `expiresIn`   | `number` | Validade da URL em segundos. Padr√£o: `3600` (1 hora). |
| `contentType` | `string` | Tipo MIME do arquivo.                                 |

## Purga de Cache

Garanta que os usu√°rios recebam o conte√∫do mais recente invalidando recursos em cache via API.

```typescript
import { Controller, Post, Body } from "azurajs/decorators";
import { AzuraCDN } from "@azurajs/cdn";

@Controller("/admin/cdn")
export class CdnAdminController {
  private cdnService: AzuraCDN;

  constructor() {
    this.cdnService = new AzuraCDN();
  }

  @Post("/purge")
  async purgeCache(@Body() body: { urls?: string[]; all?: boolean }) {
    if (body.all) {
      await this.cdnService.purgeAllCache();
      return { message: "Cache do CDN purgado com sucesso!" };
    } else if (body.urls && body.urls.length > 0) {
      await this.cdnService.purgeUrls(body.urls);
      return { message: "URLs espec√≠ficas purgadas com sucesso!" };
    }
    return { error: "Nenhuma URL ou op√ß√£o 'all' fornecida para purga." };
  }
}
```

## Pr√≥ximos Passos üìñ

- [‚öôÔ∏è **Configura√ß√£o**](/docs/pt/framework/comecando/configuracao): Veja como configurar o objeto `cdn` no seu arquivo de configura√ß√£o.
- [üõ°Ô∏è **Rate Limiting**](/docs/pt/framework/recursos/rate-limiting): Proteja seus endpoints de administra√ß√£o de CDN com Rate Limiting.
