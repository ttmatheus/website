---
title: Tratamento de Erros
description: Gerenciamento robusto e centralizado de erros no AzuraJS
category: Recursos
icon: lucide:bug
order: 8
---

# Tratamento de Erros ğŸš¨

Um tratamento de erros eficaz Ã© fundamental para a robustez de qualquer API. O AzuraJS oferece mecanismos para lidar com exceÃ§Ãµes de forma centralizada e consistente, garantindo que sua API retorne respostas significativas e evite vazamento de informaÃ§Ãµes sensÃ­veis.

## HttpError

A classe `HttpError` Ã© a maneira recomendada de lanÃ§ar erros com cÃ³digos de status HTTP especÃ­ficos dentro dos seus controllers e serviÃ§os. Ela estende a classe `Error` nativa do JavaScript.

```typescript
import { HttpError } from "azurajs/errors";
import { Controller, Get, Param, Res } from "azurajs/decorators";
import type { ResponseServer } from "azurajs/types";

@Controller("/users")
export class UserController {
  @Get("/:id")
  getUser(@Param("id") id: string, @Res() res: ResponseServer) {
    if (id === "invalid") {
      throw new HttpError(400, "ID de usuÃ¡rio invÃ¡lido");
    }
    if (id === "notfound") {
      throw new HttpError(404, "UsuÃ¡rio nÃ£o encontrado", { code: "USER_NOT_FOUND" });
    }
    return { id, name: `UsuÃ¡rio ${id}` };
  }
}
```

### Construtor de `HttpError`

```typescript
new HttpError(status: number, message?: string, payload?: any)
```

*   `status`: O cÃ³digo de status HTTP (ex: 400, 401, 404, 500).
*   `message`: Uma mensagem descritiva do erro. Se omitida, serÃ¡ gerada com base no status.
*   `payload`: Um objeto opcional com dados adicionais sobre o erro (ex: cÃ³digos de erro internos, detalhes de validaÃ§Ã£o).

## Middleware de Erro Global

O AzuraJS possui um middleware de erro padrÃ£o que captura todas as exceÃ§Ãµes lanÃ§adas e as formata em uma resposta JSON consistente. VocÃª pode personalizar esse comportamento criando seu prÃ³prio middleware de erro.

Um middleware de erro tem a assinatura `(err: Error, req: RequestServer, res: ResponseServer, next: Function)`.

```typescript
import { AzuraClient } from "azurajs";
import { HttpError } from "azurajs/errors";
import type { RequestServer, ResponseServer } from "azurajs/types";

const app = new AzuraClient();

// Seu middleware de erro personalizado
app.use((err: Error, req: RequestServer, res: ResponseServer, next: Function) => {
  if (err instanceof HttpError) {
    return res.status(err.status).json({
      statusCode: err.status,
      message: err.message,
      error: err.payload || null,
    });
  } else {
    // Erros nÃ£o tratados (500 Internal Server Error)
    console.error(err); // Logar o erro para depuraÃ§Ã£o
    return res.status(500).json({
      statusCode: 500,
      message: "Erro interno do servidor",
      error: process.env.NODE_ENV === "development" ? err.message : "",
    });
  }
});

// ... registre controllers e inicie o servidor
```

## Tratamento de Erros AssÃ­ncronos

O AzuraJS lida automaticamente com erros em funÃ§Ãµes assÃ­ncronas (promessas rejeitadas) dentro dos controllers e middlewares. VocÃª nÃ£o precisa de blocos `try/catch` em cada `async` funÃ§Ã£o, a menos que queira tratar o erro localmente.

## PrÃ³ximos Passos ğŸ“–

- [ğŸ“Š **Logger**](/docs/pt/recursos/logger): Use o logger para registrar erros de forma eficaz.
- [âš¡ **Modo Cluster**](/docs/pt/recursos/cluster-mode): Entenda como o tratamento de erros funciona em um ambiente com mÃºltiplos processos.
