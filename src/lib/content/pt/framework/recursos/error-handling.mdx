---
title: Tratamento de Erros
description: Gerenciamento robusto e centralizado de erros no AzuraJS
category: Recursos
icon: lucide:bug
order: 8
---

# Tratamento de Erros üö®

Um tratamento de erros eficaz √© fundamental para a robustez de qualquer API. O AzuraJS oferece mecanismos para lidar com exce√ß√µes de forma centralizada e consistente, garantindo que sua API retorne respostas significativas e evite vazamento de informa√ß√µes sens√≠veis.

## HttpError

A classe `HttpError` √© a maneira recomendada de lan√ßar erros com c√≥digos de status HTTP espec√≠ficos dentro dos seus controllers e servi√ßos. Ela estende a classe `Error` nativa do JavaScript.

```typescript
import { HttpError } from "azurajs/errors";
import { Controller, Get, Param, Res } from "azurajs/decorators";
import type { ResponseServer } from "azurajs/types";

@Controller("/users")
export class UserController {
  @Get("/:id")
  getUser(@Param("id") id: string, @Res() res: ResponseServer) {
    if (id === "invalid") {
      throw new HttpError(400, "ID de usu√°rio inv√°lido");
    }
    if (id === "notfound") {
      throw new HttpError(404, "Usu√°rio n√£o encontrado", { code: "USER_NOT_FOUND" });
    }
    return { id, name: `Usu√°rio ${id}` };
  }
}
```

### Construtor de `HttpError`

```typescript
new HttpError(status: number, message?: string, payload?: any)
```

*   `status`: O c√≥digo de status HTTP (ex: 400, 401, 404, 500).
*   `message`: Uma mensagem descritiva do erro. Se omitida, ser√° gerada com base no status.
*   `payload`: Um objeto opcional com dados adicionais sobre o erro (ex: c√≥digos de erro internos, detalhes de valida√ß√£o).

## Middleware de Erro Global

O AzuraJS possui um middleware de erro padr√£o que captura todas as exce√ß√µes lan√ßadas e as formata em uma resposta JSON consistente. Voc√™ pode personalizar esse comportamento criando seu pr√≥prio middleware de erro.

Um middleware de erro tem a assinatura `(err: Error, req: RequestServer, res: ResponseServer, next: Function)`.

```typescript
import { AzuraClient } from "azurajs";
import { HttpError } from "azurajs/errors";
import type { RequestServer, ResponseServer } from "azurajs/types";

const app = new AzuraClient();

// Seu middleware de erro personalizado
app.use((err: Error, req: RequestServer, res: ResponseServer, next: Function) => {
  if (err instanceof HttpError) {
    return res.status(err.status).json({
      statusCode: err.status,
      message: err.message,
      error: err.payload || null,
    });
  } else {
    // Erros n√£o tratados (500 Internal Server Error)
    console.error(err); // Logar o erro para depura√ß√£o
    return res.status(500).json({
      statusCode: 500,
      message: "Erro interno do servidor",
      error: process.env.NODE_ENV === "development" ? err.message : "",
    });
  }
});

// ... registre controllers e inicie o servidor
```

## Tratamento de Erros Ass√≠ncronos

O AzuraJS lida automaticamente com erros em fun√ß√µes ass√≠ncronas (promessas rejeitadas) dentro dos controllers e middlewares. Voc√™ n√£o precisa de blocos `try/catch` em cada `async` fun√ß√£o, a menos que queira tratar o erro localmente.

## Pr√≥ximos Passos üìñ

- [üìä **Logger**](/docs/pt/framework/recursos/logger): Use o logger para registrar erros de forma eficaz.
- [‚ö° **Modo Cluster**](/docs/pt/framework/recursos/cluster-mode): Entenda como o tratamento de erros funciona em um ambiente com m√∫ltiplos processos.
