---
title: Tratamento de Erros
description: Gerenciamento robusto e centralizado de erros no AzuraJS
category: Recursos
icon: lucide:bug
order: 8
---

# Tratamento de Erros üö®

Um tratamento de erros eficaz √© vital para a confiabilidade e seguran√ßa de qualquer API. O AzuraJS fornece mecanismos estruturados para gerenciar exce√ß√µes centralmente, garantindo respostas consistentes e evitando vazamento de dados sens√≠veis.

## HttpError

A classe `HttpError` √© a utilidade padr√£o para lan√ßar exce√ß√µes com c√≥digos de status HTTP espec√≠ficos. Ela se integra perfeitamente ao pipeline de gerenciamento de erros do framework.

```typescript
import { HttpError } from "azurajs/errors";
import { Controller, Get, Param, Res } from "azurajs/decorators";
import type { ResponseServer } from "azurajs/types";

@Controller("/users")
export class UserController {
  @Get("/:id")
  getUser(@Param("id") id: string, @Res() res: ResponseServer) {
    if (id === "invalid") {
      throw new HttpError(400, "ID de usu√°rio inv√°lido");
    }
    if (id === "notfound") {
      throw new HttpError(404, "Usu√°rio n√£o encontrado", {
        code: "USER_NOT_FOUND",
      });
    }
    return { id, name: `Usu√°rio ${id}` };
  }
}
```

### Construtor de `HttpError`

O construtor aceita um c√≥digo de status, uma mensagem e dados opcionais de payload.

```typescript
new HttpError(status: number, message?: string, payload?: any)
```

- `status`: C√≥digo de status HTTP (ex: 400, 404, 500).
- `message`: Descri√ß√£o leg√≠vel do erro. Omitir gerar√° a mensagem padr√£o do HTTP.
- `payload`: Objeto opcional contendo metadados ou detalhes estruturados do erro.

## Middleware de Erro Global

O AzuraJS intercepta exce√ß√µes n√£o tratadas atrav√©s de um middleware de erro padr√£o. Voc√™ pode sobrescrever isso para facilitar a formata√ß√£o de respostas ou logs personalizados.

Um middleware de erro personalizado deve aceitar quatro argumentos: `(err, req, res, next)`.

```typescript
import { AzuraClient } from "azurajs";
import { HttpError } from "azurajs/errors";
import type { RequestServer, ResponseServer } from "azurajs/types";

const app = new AzuraClient();

app.use(
  (err: Error, req: RequestServer, res: ResponseServer, next: Function) => {
    if (err instanceof HttpError) {
      return res.status(err.status).json({
        statusCode: err.status,
        message: err.message,
        error: err.payload || null,
      });
    } else {
      console.error(err);
      return res.status(500).json({
        statusCode: 500,
        message: "Erro interno do servidor",
        error: process.env.NODE_ENV === "development" ? err.message : "",
      });
    }
  },
);
```

## Tratamento de Erros Ass√≠ncronos

O AzuraJS captura automaticamente rejei√ß√µes de promessas dentro de m√©todos de controller ass√≠ncronos e middlewares. Blocos `try/catch` expl√≠citos s√≥ s√£o necess√°rios quando voc√™ precisa tratar erros espec√≠ficos localmente antes que eles propaguem para o manipulador global.

## Pr√≥ximos Passos üìñ

- [üìä **Logger**](/docs/pt/framework/recursos/logger): Use o logger para registrar erros de forma eficaz.
- [‚ö° **Modo Cluster**](/docs/pt/framework/recursos/cluster-mode): Entenda como o tratamento de erros funciona em um ambiente com m√∫ltiplos processos.
