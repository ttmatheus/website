---
title: Cluster Mode
description: Aproveite todos os n√∫cleos da CPU para escalar sua aplica√ß√£o AzuraJS
category: Recursos
icon: lucide:server-cog
order: 6
---

# Cluster Mode ‚ö°

O AzuraJS oferece suporte nativo ao modo cluster, permitindo que sua aplica√ß√£o utilize todos os n√∫cleos dispon√≠veis da CPU. Isso √© crucial para escalar aplica√ß√µes Node.js e Bun, distribuindo a carga de trabalho entre m√∫ltiplos processos e melhorando significativamente a performance e a resili√™ncia.

## Como Funciona

Quando o modo cluster √© ativado, o AzuraJS cria um processo *master* e v√°rios processos *worker*. O processo master √© respons√°vel por gerenciar os workers, reinici√°-los em caso de falha e distribuir as requisi√ß√µes de entrada entre eles. Cada worker √© uma inst√¢ncia independente da sua aplica√ß√£o.

## Configura√ß√£o

Para habilitar o modo cluster, basta definir `cluster: true` no seu arquivo `azura.config.ts`:

```typescript
// azura.config.ts
import type { ConfigTypes } from "azurajs/config";

const config: ConfigTypes = {
  environment: "production", // Cluster mode √© mais comum em produ√ß√£o
  server: {
    port: 3000,
    cluster: true,           // Habilita o modo cluster
    // workers: 4,            // Opcional: n√∫mero espec√≠fico de workers (padr√£o: n√∫mero de CPUs)
  },
  // ...
};

export default config;
```

### Op√ß√µes de `cluster`

| Propriedade | Tipo | Descri√ß√£o |
| :--- | :--- | :--- |
| `cluster` | `boolean` | Se `true`, o AzuraJS iniciar√° em modo cluster. Padr√£o: `false`. |
| `workers` | `number` | Opcional. N√∫mero de processos worker a serem criados. Se n√£o especificado, usar√° o n√∫mero de n√∫cleos da CPU. |

## Benef√≠cios do Cluster Mode

*   **Performance Aprimorada**: Distribui a carga entre os n√∫cleos da CPU, processando mais requisi√ß√µes simultaneamente.
*   **Alta Disponibilidade**: Se um processo worker falhar, o master pode reinici√°-lo sem derrubar toda a aplica√ß√£o.
*   **Utiliza√ß√£o Eficiente de Recursos**: Maximiza o uso do hardware do servidor.

## Considera√ß√µes Importantes

*   **Estado Compartilhado**: Evite armazenar estado na mem√≥ria dos processos worker, pois cada um √© isolado. Use bancos de dados, Redis ou outras solu√ß√µes de cache distribu√≠do para estado compartilhado.
*   **Sess√µes**: Se voc√™ usa sess√µes, elas devem ser armazenadas em um local centralizado (ex: Redis) para que todos os workers possam acess√°-las.
*   **Logging**: Certifique-se de que seu sistema de logging seja capaz de lidar com logs de m√∫ltiplos processos worker (ex: enviando para um servi√ßo centralizado como ELK Stack ou Grafana Loki).

## Pr√≥ximos Passos üìñ

- [üö® **Tratamento de Erros**](/docs/pt/recursos/error-handling): Entenda como lidar com erros em um ambiente clusterizado.
- [üìä **Logger**](/docs/pt/recursos/logger): Configure seu logger para o modo cluster.
